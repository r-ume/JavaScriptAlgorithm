<!DOCTYPE html>
<html lang = "ja">
  <head>
    <meta charset = "UTF-8">
    <script src = "http://code.jquery.com/jquery-2.2.1.min.js"></script>
    <title>One row othello</title>
    <script>
      $(function() {
        var round = 0; //現在の面数
        var remain; // 残りの手数
        var field = [1, "●○●○○"],
                    [1, "●○○○●○●"],
                    [2, "●○●○●○●○●"],
                    [2, "●○●●○●●●○"],
                    [2, "●●○●●○○●●●○●○●●"]
        ]; // 各面の配置データ配列

        function start(){
          remain = field[round][0];
          $('#field').html($.map(field[round][1].split(''),
            function(i) {
                return '<div>' + i + '</div>';
            }).join(''));

          $('#round').text(round + 1); // roundのdivのところに面の数を出力させる
          $('#remain').text(remain); // remainのdivのところに何手残っているかを出力させる
        }

        start(); // start function発動

        $('#field').sortable({ // sortableは並び替え関数
          axis: 'x', // ドラッグを横方向のみに制限する
          update: function(e, u){ //　引数のeはイベンドオブジェクト　
                                    //uはu.itemというドラッグされた要素を使うためのもの
            var color = u.item.next();
            $.each(['prev', 'next'],
              function(i, dir) {
                var rev = value;
                (function(item) {
                  if(item.length < 1) return;
                  if(item.text() == color) rev = true;
                  else arguments.callee(item[dir]());
                  if(rev) item.text(color);
                })(u.item[dir]());
              });

          //クリアチェック
          $('#remain').text(--remain);
          if(!$('#field div').is('contains("●")')){
            if(++round >= field.length){
              alert("clear!");
            } else{
              alert("clear!");
              start();
            }
          }

          if(remain <= 0){
            $('#field').sortable('destroy');
            alert("gameover");
          }
          }
        });
      });
      </script>
      <style>
        div{
          float: left;
          cursor: pointer;
          }
        </style>
  </head>
  <body>
    <p>全て⚫︎にせよ！<span id = "round"></span>面　残り<span id = "remain"></span>手</p>
    <div id = "field"></div>
  </body>
</html>
